<div class="profile-overview-container">
    <mat-card class="bank-selector mb-4">
        <mat-card-content>
            <mat-form-field appearance="fill">
                <mat-label>Select Bank</mat-label>
                <mat-select [value]="selectedBank?.institutionKey" (selectionChange)="selectBank($event.value)">
                    <mat-option *ngFor="let bank of favoriteBanks" [value]="bank">
                        {{bank.name}} - {{bank.location}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </mat-card-content>
    </mat-card>

    <div class="profile-content" *ngIf="selectedBank">
        <mat-card class="introduction mb-4" *ngIf="bankProfile.introduction">
            <mat-card-header>
                <mat-card-title>Bank Profile</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Name:</strong> {{bankProfile.introduction.name}}</p>
                        <p><strong>Location:</strong> {{bankProfile.introduction.location}}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Asset Size:</strong> {{bankProfile.introduction.assetSize | currency}}</p>
                        <p><strong>Type:</strong> {{bankProfile.introduction.type}}</p>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>

        <mat-card class="details">
            <mat-card-header>
                <mat-card-title>Performance Details</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <mat-tab-group [(selectedIndex)]="activeTab === 'QTD' ? 0 : 1"
                    (selectedIndexChange)="setActiveTab($event === 0 ? 'QTD' : 'YTD')">
                    <mat-tab label="Quarter to Date">
                        <div class="table-container mt-3">
                            <table mat-table [dataSource]="bankProfile.detailsQtd" class="mat-elevation-z8">
                                <ng-container *ngFor="let header of bankProfile.qtrHeaders | keyvalue">
                                    <ng-container [matColumnDef]="header.key">
                                        <th mat-header-cell *matHeaderCellDef>{{header.value}}</th>
                                        <td mat-cell *matCellDef="let element">{{element[header.key]}}</td>
                                    </ng-container>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="bankProfile.qtrHeaders | keyvalue | map:'key'">
                                </tr>
                                <tr mat-row
                                    *matRowDef="let row; columns: bankProfile.qtrHeaders | keyvalue | map:'key';"></tr>
                            </table>
                        </div>
                    </mat-tab>

                    <mat-tab label="Year to Date">
                        <div class="table-container mt-3">
                            <table mat-table [dataSource]="bankProfile.detailsYtd" class="mat-elevation-z8">
                                <ng-container *ngFor="let header of bankProfile.ytdHeaders | keyvalue">
                                    <ng-container [matColumnDef]="header.key">
                                        <th mat-header-cell *matHeaderCellDef>{{header.value}}</th>
                                        <td mat-cell *matCellDef="let element">{{element[header.key]}}</td>
                                    </ng-container>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="bankProfile.ytdHeaders | keyvalue | map:'key'">
                                </tr>
                                <tr mat-row
                                    *matRowDef="let row; columns: bankProfile.ytdHeaders | keyvalue | map:'key';"></tr>
                            </table>
                        </div>
                    </mat-tab>
                </mat-tab-group>
            </mat-card-content>
        </mat-card>
    </div>

    <div class="no-data" *ngIf="!selectedBank">
        <mat-card>
            <mat-card-content>
                <p>Please select a bank to view its profile.</p>
            </mat-card-content>
        </mat-card>
    </div>
</div>
